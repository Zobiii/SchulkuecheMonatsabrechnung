<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:Schulkueche.App.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
        x:Class="Schulkueche.App.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/avalonia-logo.ico"
    Title="Gemeinde-Küche">

    <Design.DataContext>
        <!-- This only sets the DataContext for the previewer in an IDE,
             to set the actual DataContext for runtime, set the DataContext property in code (look at App.axaml.cs) -->
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <TabControl>
        <TabItem Header="Personen">
            <ScrollViewer>
                <StackPanel Spacing="8" Margin="16" DataContext="{Binding Personen}">
                    <Grid ColumnDefinitions="Auto,*,Auto,Auto,Auto" RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto">
                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Name:" Margin="0,4"/>
                        <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding Name, Mode=TwoWay}"/>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Kategorie:" Margin="0,4"/>
                        <ComboBox Grid.Row="1" Grid.Column="1" SelectedIndex="{Binding Category}">
                            <ComboBoxItem>Pensionist</ComboBoxItem>
                            <ComboBoxItem>Kindergruppe</ComboBoxItem>
                            <ComboBoxItem>Gratis</ComboBoxItem>
                        </ComboBox>

                        <CheckBox Grid.Row="1" Grid.Column="3" IsChecked="{Binding DefaultDelivery, Mode=TwoWay}" Content="Lieferung?"/>

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Strasse:" Margin="0,4"/>
                        <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding Street, Mode=TwoWay}"/>
                        <TextBlock Grid.Row="2" Grid.Column="2" Text="Hsnr:" Margin="12,4,4,4"/>
                        <TextBox Grid.Row="2" Grid.Column="3" Width="100" Text="{Binding HouseNumber, Mode=TwoWay}"/>

                        <TextBlock Grid.Row="3" Grid.Column="0" Text="PLZ:" Margin="0,4"/>
                        <TextBox Grid.Row="3" Grid.Column="1" Width="120" Text="{Binding Zip, Mode=TwoWay}"/>
                        <TextBlock Grid.Row="3" Grid.Column="2" Text="Ort:" Margin="12,4,4,4"/>
                        <TextBox Grid.Row="3" Grid.Column="3" Text="{Binding City, Mode=TwoWay}"/>

                        <TextBlock Grid.Row="4" Grid.Column="0" Text="Kontakt:" Margin="0,4"/>
                        <TextBox Grid.Row="4" Grid.Column="1" Text="{Binding Contact, Mode=TwoWay}"/>

                        <TextBlock Grid.Row="5" Grid.Column="0" Text="Individueller Essenspreis (€):" Margin="0,4"/>
                        <TextBox Grid.Row="5" Grid.Column="1" Text="{Binding CustomMealPrice, Mode=TwoWay}"/>
                    </Grid>

                    <StackPanel Orientation="Horizontal" Spacing="12" Margin="0,8,0,0">
                        <Button Content="Speichern" Command="{Binding SpeichernCommand}"/>
                        <Button Content="Neu" Command="{Binding NeuCommand}"/>
                        <Button Content="Aktualisieren" Command="{Binding LadenCommand}"/>
                        <Button Content="Löschen" Command="{Binding LoeschenCommand}"/>
                    </StackPanel>

                    <Separator Margin="0,8"/>
                    <TextBlock Text="Vorhandene Personen" FontWeight="Bold"/>
                    <ListBox ItemsSource="{Binding PersonenListe}" SelectedItem="{Binding SelectedPerson, Mode=TwoWay}" Height="200">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Name}"/>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </StackPanel>
            </ScrollViewer>
        </TabItem>

        <TabItem Header="Schnellerfassung">
            <StackPanel Spacing="8" Margin="12" DataContext="{Binding Erfassung}">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <TextBlock Text="Datum:" VerticalAlignment="Center"/>
                    <DatePicker SelectedDate="{Binding SelectedDate, Mode=TwoWay}"/>
                    <Button Content="Alle Mengen = 0" Command="{Binding AlleMengenNullCommand}"/>
                    <Button Content="Speichern" Command="{Binding SpeichernCommand}"/>
                </StackPanel>

                <ScrollViewer Height="400">
                    <ItemsControl ItemsSource="{Binding Zeilen}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate x:DataType="vm:ErfassungViewModel+Row">
                                <Grid ColumnDefinitions="*,Auto,Auto" Margin="4">
                                    <TextBlock Grid.Column="0" Text="{Binding DisplayName}"/>
                                    <TextBox Grid.Column="1" Width="80" Text="{Binding Quantity, Mode=TwoWay}"/>
                                    <CheckBox Grid.Column="2" Content="Lieferung?" IsChecked="{Binding Delivery, Mode=TwoWay}"/>
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </StackPanel>
        </TabItem>

        <TabItem Header="Abrechnung">
            <StackPanel Spacing="8" Margin="12" DataContext="{Binding Abrechnung}">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <TextBlock Text="Monat:" VerticalAlignment="Center"/>
                    <NumericUpDown Minimum="1" Maximum="12" Value="{Binding Monat, Mode=TwoWay}"/>
                    <TextBlock Text="Jahr:" VerticalAlignment="Center"/>
                    <NumericUpDown Minimum="2024" Maximum="2100" Value="{Binding Jahr, Mode=TwoWay}"/>
                    <Button Content="Berechnen" Command="{Binding BerechnenCommand}"/>
                    <Button Content="PDF exportieren" Command="{Binding ExportPdfCommand}"/>
                </StackPanel>
                <ListBox ItemsSource="{Binding Zeilen}" Height="400"/>
                <StackPanel Orientation="Vertical" Spacing="4">
                    <TextBlock Text="Summen" FontWeight="Bold"/>
                    <TextBlock Text="{Binding SummePensionisten, StringFormat='Pensionisten: {0:C}'}"/>
                    <TextBlock Text="{Binding SummeKinder, StringFormat='Kinder: {0:C}'}"/>
                    <TextBlock Text="{Binding SummeGratis, StringFormat='Gratis: {0:C}'}"/>
                    <TextBlock Text="{Binding SummeGesamt, StringFormat='Gesamt: {0:C}'}" FontWeight="Bold"/>
                </StackPanel>
            </StackPanel>
        </TabItem>
    </TabControl>

</Window>
